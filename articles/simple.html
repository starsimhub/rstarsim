<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simple usage • starsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simple usage">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">starsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/simple.html">Simple usage</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced usage</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>User guides</h6></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/starsimhub/rstarsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simple usage</h1>
            
            <h4 data-toc-skip class="date">2024-11-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/starsimhub/rstarsim/blob/main/vignettes/simple.Rmd" class="external-link"><code>vignettes/simple.Rmd</code></a></small>
      <div class="d-none name"><code>simple.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="simple-usage-example">Simple usage example<a class="anchor" aria-label="anchor" href="#simple-usage-example"></a>
</h2>
<p>This example walks through the steps for creating and running a
simple Starsim simulation. Here, “simple” means that you are configuring
(i.e., setting the parameters for) existing Starsim modules, rather than
writing new ones.</p>
<div class="section level3">
<h3 id="load-starsim">Load Starsim<a class="anchor" aria-label="anchor" href="#load-starsim"></a>
</h3>
<p>The <code>starsim</code> package only contains three functions –
<code><a href="../reference/init_starsim.html">init_starsim()</a></code>, <code><a href="../reference/reinstall_starsim.html">reinstall_starsim()</a></code>, and
<code><a href="../reference/load_starsim.html">load_starsim()</a></code>. The first one you should only need to do
once, the second one you might not need to do at all, and the third one
is how you access all of Starsim’s functionality:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.starsim.org/">starsim</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/load_starsim.html">load_starsim</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For the most “Pythonic” experience, you can do everything via the
<code>ss</code> variable, which corresponds to
<code>import starsim as ss</code> in Python. However, for a more “R-ish”
experience, you can also use some of the most important classes
directly, all of which can also be accessed via <code>ss</code>. For
example, <code>sim &lt;- ss$Sim()</code> and
<code>sim &lt;- Sim()</code> are identical.</p>
<p>For ease of use, Starsim also imports several key
<code>reticulate</code> functions, including <code>import</code> and
<code>PyClass</code>.</p>
</div>
<div class="section level3">
<h3 id="configure-a-starsim-run">Configure a Starsim run<a class="anchor" aria-label="anchor" href="#configure-a-starsim-run"></a>
</h3>
<p>Starsim simulations can be configured either by supplying a list of
<em>parameter values</em>, or a list of <em>objects</em>. These two
approaches are equivalent. For simple sims, it’s usually easiest to use
parameter values. For more complex sims, it’s usually easiest to use
objects.</p>
<p>Here’s what it looks like to configure a sim using a list of
parameter values:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  n_agents <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  birth_rate <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  death_rate <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  networks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">'randomnet'</span>,</span>
<span>    n_contacts <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span>,</span>
<span>  diseases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">'sir'</span>,</span>
<span>    dur_inf <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here’s the identical simulation, but configured using objects:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_agents</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">births</span> <span class="op">&lt;-</span> <span class="va">ss</span><span class="op">$</span><span class="fu">Births</span><span class="op">(</span>birth_rate<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">deaths</span> <span class="op">&lt;-</span> <span class="va">ss</span><span class="op">$</span><span class="fu">Deaths</span><span class="op">(</span>death_rate<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">random</span> <span class="op">&lt;-</span> <span class="va">ss</span><span class="op">$</span><span class="fu">RandomNet</span><span class="op">(</span>n_contacts<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">sir</span> <span class="op">&lt;-</span> <span class="va">ss</span><span class="op">$</span><span class="fu">SIR</span><span class="op">(</span>dur_inf<span class="op">=</span><span class="fl">10</span>, beta<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-and-run-a-sim">Create and run a sim<a class="anchor" aria-label="anchor" href="#create-and-run-a-sim"></a>
</h3>
<p>To create a sim using parameters, we can simply supply that as an
argument:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">Sim</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
<p>Any valid parameter name (e.g. <code>networks</code>) can also be
supplied directly to a sim. So our “object sim” would look like
this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu">Sim</span><span class="op">(</span></span>
<span>  label <span class="op">=</span> <span class="st">'Objects'</span>,</span>
<span>  n_agents <span class="op">=</span> <span class="va">n_agents</span>,</span>
<span>  demographics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">births</span>, <span class="va">deaths</span><span class="op">)</span>,</span>
<span>  networks <span class="op">=</span> <span class="va">random</span>,</span>
<span>  diseases <span class="op">=</span> <span class="va">sir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s run both sims and confirm that they match:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sim2</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; Initializing sim with 10000 agents</span></span>
<span><span class="co">#&gt;   Running 2000.0 ( 0/51) (0.00 s)  ———————————————————— 2%</span></span>
<span><span class="co">#&gt;   Running 2010.0 (10/51) (0.08 s)  ••••———————————————— 22%</span></span>
<span><span class="co">#&gt;   Running 2020.0 (20/51) (0.17 s)  ••••••••———————————— 41%</span></span>
<span><span class="co">#&gt;   Running 2030.0 (30/51) (0.24 s)  ••••••••••••———————— 61%</span></span>
<span><span class="co">#&gt;   Running 2040.0 (40/51) (0.31 s)  ••••••••••••••••———— 80%</span></span>
<span><span class="co">#&gt;   Running 2050.0 (50/51) (0.39 s)  •••••••••••••••••••• 100%</span></span>
<span><span class="co">#&gt; Sim(n=10000; 2000—2050; networks=randomnet; demographics=births, deaths; diseases=sir)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing sim "Objects" with 10000 agents</span></span>
<span><span class="co">#&gt;   Running "Objects": 2000.0 ( 0/51) (0.00 s)  ———————————————————— 2%</span></span>
<span><span class="co">#&gt;   Running "Objects": 2010.0 (10/51) (0.07 s)  ••••———————————————— 22%</span></span>
<span><span class="co">#&gt;   Running "Objects": 2020.0 (20/51) (0.15 s)  ••••••••———————————— 41%</span></span>
<span><span class="co">#&gt;   Running "Objects": 2030.0 (30/51) (0.23 s)  ••••••••••••———————— 61%</span></span>
<span><span class="co">#&gt;   Running "Objects": 2040.0 (40/51) (0.30 s)  ••••••••••••••••———— 80%</span></span>
<span><span class="co">#&gt;   Running "Objects": 2050.0 (50/51) (0.38 s)  •••••••••••••••••••• 100%</span></span>
<span><span class="co">#&gt; Sim(Objects; n=10000; 2000—2050; networks=randomnet; demographics=births, deaths; diseases=sir)</span></span></code></pre></div>
<p>Let’s check that the results of the two sims match:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span><span class="op">$</span><span class="fu">check_sims_match</span><span class="op">(</span><span class="va">sim</span>, <span class="va">sim2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sims match</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="built-in-plotting">Built-in plotting<a class="anchor" aria-label="anchor" href="#built-in-plotting"></a>
</h3>
<p>To plot all the results in a sim, we can call
<code>sim$plot()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple-sim.png" alt="Sim plot"></p>
<p>(If your plot doesn’t show up or looks stupendously ugly, please see
the troubleshooting section of the readme.)</p>
<p>To plot just the results from our disease module, we can call
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> for that disease:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span><span class="op">$</span><span class="va">diseases</span><span class="op">$</span><span class="va">sir</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple-sir.png" alt="SIR plot"></p>
</div>
<div class="section level3">
<h3 id="custom-plotting">Custom plotting<a class="anchor" aria-label="anchor" href="#custom-plotting"></a>
</h3>
<p>Eventually, you are going to want to do some custom plotting. The
easiest way to do this is to export your results to a dataframe, and
then plot as you usually would. For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">sir</span><span class="op">$</span><span class="fu">to_df</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">timevec</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">n_susceptible</span>, colour <span class="op">=</span> <span class="st">"Susceptible"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">n_infected</span>, colour <span class="op">=</span> <span class="st">"Infected"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">n_recovered</span>, colour <span class="op">=</span> <span class="st">"Recovered"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple-custom.png" alt="Custom ggplot"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cliff Kerr, Robyn Stuart, Romesh Abeysuriya, Daniel Klein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
